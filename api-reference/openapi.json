{
  "openapi": "3.1.0",
  "info": {
    "title": "StackSee API",
    "description": "StackSee API for analyzing websites and extracting technology stack information",
    "license": {
      "name": "MIT"
    },
    "version": "1.0.0"
  },
  "servers": [
    {
      "url": "https://api.stacksee.com"
    }
  ],
  "security": [
    {
      "apiKeyAuth": []
    }
  ],
  "paths": {
    "/api/v1/domain/analyze": {
      "post": {
        "summary": "Analyze Website",
        "description": "Analyzes a website to extract technology stack information, frameworks, libraries, and branding details. Supports both synchronous and asynchronous processing with webhook notifications.",
        "operationId": "analyzeWebsite",
        "tags": ["Domain Analysis"],
        "requestBody": {
          "description": "Website analysis configuration",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AnalyzeRequest"
              },
              "examples": {
                "basic": {
                  "summary": "Basic analysis",
                  "value": {
                    "url": "https://example.com",
                    "deepScan": false
                  }
                },
                "deep-scan": {
                  "summary": "Deep scan with custom settings",
                  "value": {
                    "url": "https://example.com",
                    "deepScan": true,
                    "maxDepth": 3,
                    "timeout": 45000,
                    "includeBrand": true,
                    "freshness": "fresh"
                  }
                },
                "with-webhook": {
                  "summary": "Async analysis with webhook",
                  "value": {
                    "url": "https://example.com",
                    "deepScan": true,
                    "webhookUrl": "https://your-app.com/webhook",
                    "webhookSecret": "your-secret-key",
                    "maxWait": 10
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Analysis completed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/AnalyzeResponse"
                    },
                    {
                      "$ref": "#/components/schemas/CachedAnalyzeResponse"
                    },
                    {
                      "$ref": "#/components/schemas/AsyncScanResponse"
                    }
                  ]
                },
                "examples": {
                  "quick-scan": {
                    "summary": "Quick scan result",
                    "value": {
                      "profile": {
                        "url": "https://example.com",
                        "domain": "example.com",
                        "scannedAt": "2024-01-15T10:30:00.000Z",
                        "scan": {
                          "type": "quick",
                          "coverage": 1
                        }
                      },
                      "stack": {
                        "components": [
                          {
                            "name": "React",
                            "identifier": "react",
                            "detectedVersions": ["18.2.0"],
                            "classification": [
                              {
                                "label": "JavaScript Framework",
                                "key": "js-framework"
                              }
                            ],
                            "certainty": 95,
                            "metadata": {
                              "icon": "https://api.stacksee.com/icons/react.svg",
                              "homepage": "https://react.dev",
                              "summary": "A JavaScript library for building user interfaces"
                            }
                          },
                          {
                            "name": "Next.js",
                            "identifier": "nextjs",
                            "detectedVersions": ["14.0.4"],
                            "classification": [
                              {
                                "label": "React Framework",
                                "key": "react-framework"
                              }
                            ],
                            "certainty": 98,
                            "metadata": {
                              "icon": "https://api.stacksee.com/icons/nextjs.svg",
                              "homepage": "https://nextjs.org",
                              "summary": "The React Framework for the Web"
                            }
                          }
                        ],
                        "summary": {
                          "total": 2,
                          "byType": {
                            "js-framework": 1,
                            "react-framework": 1
                          }
                        }
                      },
                      "identity": {
                        "name": "Example Company",
                        "domain": "example.com",
                        "tagline": "Building the future of web",
                        "about": "We create amazing web experiences",
                        "branding": {
                          "primaryLogo": "https://example.com/logo.png",
                          "favicon": "https://example.com/favicon.ico",
                          "palette": {
                            "primary": "#0070f3",
                            "accent": "#ff4081"
                          }
                        },
                        "social": {
                          "twitter": "https://twitter.com/example",
                          "github": "https://github.com/example",
                          "linkedin": "https://linkedin.com/company/example"
                        }
                      }
                    }
                  },
                  "cached": {
                    "summary": "Cached result",
                    "value": {
                      "profile": {
                        "url": "https://example.com",
                        "domain": "example.com",
                        "scannedAt": "2024-01-15T09:00:00.000Z",
                        "scan": {
                          "type": "quick",
                          "coverage": 1
                        }
                      },
                      "stack": {
                        "components": [
                          {
                            "name": "React",
                            "identifier": "react",
                            "detectedVersions": ["18.2.0"],
                            "classification": [
                              {
                                "label": "JavaScript Framework",
                                "key": "js-framework"
                              }
                            ],
                            "certainty": 95
                          }
                        ],
                        "summary": {
                          "total": 1,
                          "byType": {
                            "js-framework": 1
                          }
                        }
                      },
                      "cache": {
                        "hit": true,
                        "age": 5400,
                        "taskId": "task_abc123"
                      }
                    }
                  },
                  "async": {
                    "summary": "Async scan initiated",
                    "value": {
                      "url": "https://example.com",
                      "status": "scanning",
                      "taskId": "task_xyz789",
                      "estimatedDuration": "2-3 minutes",
                      "statusUrl": "https://api.stacksee.com/api/v1/tasks/task_xyz789/status",
                      "webhookConfigured": true,
                      "message": "Analysis is taking longer than expected. Results will be sent to your webhook when complete."
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid request data",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "error": "Invalid request data",
                  "message": "URL is required"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing API key",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "description": "Rate limit exceeded",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "AnalyzeRequest": {
        "type": "object",
        "required": ["url"],
        "properties": {
          "url": {
            "type": "string",
            "description": "The URL of the website to analyze. Domain validation and normalization happens automatically.",
            "example": "https://example.com"
          },
          "deepScan": {
            "type": "boolean",
            "description": "Enable deep scanning to analyze multiple pages and extract more detailed information",
            "default": false
          },
          "maxDepth": {
            "type": "integer",
            "description": "Maximum depth for deep scanning (1-10)",
            "minimum": 1,
            "maximum": 10,
            "default": 5
          },
          "timeout": {
            "type": "integer",
            "description": "Request timeout in milliseconds (1000-60000)",
            "minimum": 1000,
            "maximum": 60000,
            "default": 30000
          },
          "includeBrand": {
            "type": "boolean",
            "description": "Include brand information (logo, colors, etc.) in the response",
            "default": true
          },
          "freshness": {
            "type": "string",
            "enum": ["cached", "fresh", "auto"],
            "description": "Cache freshness preference: 'cached' (use cache if available), 'fresh' (always fetch new data), 'auto' (smart caching)",
            "default": "auto"
          },
          "maxCacheAge": {
            "type": "integer",
            "description": "Maximum cache age in hours (1-720, max 30 days)",
            "minimum": 1,
            "maximum": 720,
            "default": 168
          },
          "maxWait": {
            "type": "integer",
            "description": "Maximum time to wait for synchronous response in seconds (10-60). If analysis takes longer, it continues asynchronously.",
            "minimum": 10,
            "maximum": 60,
            "default": 30
          },
          "minConfidence": {
            "type": "integer",
            "description": "Minimum confidence score (0-100) for technology detection",
            "minimum": 0,
            "maximum": 100,
            "default": 50
          },
          "webhookUrl": {
            "type": "string",
            "format": "uri",
            "description": "Webhook URL to receive analysis results for async processing",
            "example": "https://your-app.com/webhook"
          },
          "webhookSecret": {
            "type": "string",
            "description": "Secret key for webhook signature verification",
            "example": "your-secret-key"
          }
        }
      },
      "AnalyzeResponse": {
        "type": "object",
        "description": "Standard website analysis results including detected technologies and branding information",
        "required": ["profile", "stack"],
        "properties": {
          "profile": {
            "$ref": "#/components/schemas/ProfileMetadata"
          },
          "stack": {
            "$ref": "#/components/schemas/Stack"
          },
          "identity": {
            "$ref": "#/components/schemas/BrandIdentity"
          }
        }
      },
      "CachedAnalyzeResponse": {
        "type": "object",
        "description": "Cached analysis results with cache metadata",
        "required": ["profile", "stack", "cache"],
        "properties": {
          "profile": {
            "$ref": "#/components/schemas/ProfileMetadata"
          },
          "stack": {
            "$ref": "#/components/schemas/Stack"
          },
          "identity": {
            "$ref": "#/components/schemas/BrandIdentity"
          },
          "cache": {
            "type": "object",
            "required": ["hit", "age"],
            "properties": {
              "hit": {
                "type": "boolean",
                "enum": [true],
                "description": "Always true for cached responses"
              },
              "age": {
                "type": "integer",
                "minimum": 0,
                "description": "Age of cached data in seconds"
              },
              "taskId": {
                "type": "string",
                "description": "Reference to the original analysis task"
              }
            }
          }
        }
      },
      "AsyncScanResponse": {
        "type": "object",
        "description": "Response when analysis exceeds maxWait and continues asynchronously",
        "required": ["url", "status", "taskId", "estimatedDuration", "statusUrl", "webhookConfigured", "message"],
        "properties": {
          "url": {
            "type": "string",
            "format": "uri",
            "description": "The URL being analyzed"
          },
          "status": {
            "type": "string",
            "enum": ["scanning"],
            "description": "Current status of the analysis"
          },
          "taskId": {
            "type": "string",
            "description": "Unique identifier for this analysis task"
          },
          "estimatedDuration": {
            "type": "string",
            "description": "Human-readable estimate of completion time",
            "example": "2-3 minutes"
          },
          "statusUrl": {
            "type": "string",
            "description": "URL to poll for task status and results"
          },
          "webhookConfigured": {
            "type": "boolean",
            "description": "Whether a webhook is configured to receive results"
          },
          "message": {
            "type": "string",
            "description": "Human-readable message about the async processing"
          }
        }
      },
      "ProfileMetadata": {
        "type": "object",
        "description": "Metadata about the analyzed website",
        "required": ["url", "domain", "scannedAt", "scan"],
        "properties": {
          "url": {
            "type": "string",
            "format": "uri",
            "description": "The analyzed URL"
          },
          "domain": {
            "type": "string",
            "description": "Normalized domain name"
          },
          "scannedAt": {
            "type": "string",
            "format": "date-time",
            "description": "ISO 8601 timestamp of when the scan was performed"
          },
          "scan": {
            "$ref": "#/components/schemas/ScanMetadata"
          }
        }
      },
      "ScanMetadata": {
        "type": "object",
        "description": "Details about the scan performed",
        "required": ["type", "coverage"],
        "properties": {
          "type": {
            "type": "string",
            "enum": ["quick", "deep"],
            "description": "Type of scan performed"
          },
          "coverage": {
            "type": "integer",
            "minimum": 1,
            "description": "Number of pages analyzed"
          }
        }
      },
      "Stack": {
        "type": "object",
        "description": "Detected technology stack information",
        "required": ["components", "summary"],
        "properties": {
          "components": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/StackComponent"
            },
            "description": "List of detected technologies"
          },
          "summary": {
            "$ref": "#/components/schemas/StackSummary"
          }
        }
      },
      "StackComponent": {
        "type": "object",
        "description": "A detected technology or framework",
        "required": ["name", "identifier", "detectedVersions", "classification"],
        "properties": {
          "name": {
            "type": "string",
            "description": "Display name of the technology"
          },
          "identifier": {
            "type": "string",
            "description": "Unique identifier for the technology"
          },
          "detectedVersions": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Detected version numbers"
          },
          "classification": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TechnologyClassification"
            },
            "description": "Technology categories and classifications"
          },
          "certainty": {
            "type": "integer",
            "minimum": 0,
            "maximum": 100,
            "description": "Confidence score for the detection (0-100)"
          },
          "metadata": {
            "$ref": "#/components/schemas/TechnologyMetadata"
          }
        }
      },
      "TechnologyClassification": {
        "type": "object",
        "description": "Classification of a technology",
        "required": ["label", "key"],
        "properties": {
          "label": {
            "type": "string",
            "description": "Human-readable category label"
          },
          "key": {
            "type": "string",
            "description": "Machine-readable category key"
          }
        }
      },
      "TechnologyMetadata": {
        "type": "object",
        "description": "Additional metadata about a technology",
        "properties": {
          "icon": {
            "type": "string",
            "format": "uri",
            "description": "URL to technology icon/logo"
          },
          "homepage": {
            "type": "string",
            "format": "uri",
            "nullable": true,
            "description": "Technology's homepage URL"
          },
          "summary": {
            "type": "string",
            "nullable": true,
            "description": "Brief description of the technology"
          }
        }
      },
      "StackSummary": {
        "type": "object",
        "description": "Summary statistics about the detected stack",
        "required": ["total"],
        "properties": {
          "total": {
            "type": "integer",
            "minimum": 0,
            "description": "Total number of detected technologies"
          },
          "byType": {
            "type": "object",
            "additionalProperties": {
              "type": "integer",
              "minimum": 0
            },
            "description": "Count of technologies grouped by category"
          }
        }
      },
      "BrandIdentity": {
        "type": "object",
        "description": "Brand and identity information extracted from the website",
        "required": ["name", "domain"],
        "properties": {
          "name": {
            "type": "string",
            "description": "Company or website name"
          },
          "domain": {
            "type": "string",
            "description": "Primary domain"
          },
          "tagline": {
            "type": "string",
            "description": "Company tagline or slogan"
          },
          "about": {
            "type": "string",
            "description": "Company description or about text"
          },
          "branding": {
            "type": "object",
            "properties": {
              "primaryLogo": {
                "type": "string",
                "format": "uri",
                "description": "URL to primary logo"
              },
              "favicon": {
                "type": "string",
                "format": "uri",
                "description": "URL to favicon"
              },
              "palette": {
                "type": "object",
                "properties": {
                  "primary": {
                    "type": "string",
                    "nullable": true,
                    "description": "Primary brand color (hex code)",
                    "example": "#0070f3"
                  },
                  "accent": {
                    "type": "string",
                    "nullable": true,
                    "description": "Accent brand color (hex code)",
                    "example": "#ff4081"
                  }
                }
              }
            }
          },
          "social": {
            "type": "object",
            "properties": {
              "twitter": {
                "type": "string",
                "format": "uri",
                "description": "Twitter/X profile URL"
              },
              "linkedin": {
                "type": "string",
                "format": "uri",
                "description": "LinkedIn profile URL"
              },
              "facebook": {
                "type": "string",
                "format": "uri",
                "description": "Facebook page URL"
              },
              "instagram": {
                "type": "string",
                "format": "uri",
                "description": "Instagram profile URL"
              },
              "github": {
                "type": "string",
                "format": "uri",
                "description": "GitHub organization URL"
              },
              "youtube": {
                "type": "string",
                "format": "uri",
                "description": "YouTube channel URL"
              },
              "tiktok": {
                "type": "string",
                "format": "uri",
                "description": "TikTok profile URL"
              }
            }
          }
        }
      },
      "Error": {
        "type": "object",
        "required": ["error", "message"],
        "properties": {
          "error": {
            "type": "string",
            "description": "Error type or code"
          },
          "message": {
            "type": "string",
            "description": "Human-readable error message"
          }
        }
      }
    },
    "securitySchemes": {
      "apiKeyAuth": {
        "type": "apiKey",
        "in": "header",
        "name": "X-API-Key",
        "description": "API key for authentication. Include your API key in the X-API-Key header."
      }
    }
  }
}